(this["webpackJsonpnss-qrgen"]=this["webpackJsonpnss-qrgen"]||[]).push([[0],{133:function(e,t,n){},134:function(e,t,n){},142:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},157:function(e,t){},159:function(e,t){},170:function(e,t){},172:function(e,t){},199:function(e,t){},201:function(e,t){},202:function(e,t){},207:function(e,t){},209:function(e,t){},228:function(e,t){},240:function(e,t){},243:function(e,t){},246:function(e,t,n){},247:function(e,t,n){},248:function(e,t,n){"use strict";n.r(t);var a=n(6),s=n.n(a),i=n(125),r=n.n(i),o=(n(133),n(10)),c=n(15),l=n(17),u=n(16),d=(n(134),n(8)),p=n.n(d),h=n(18),v=n(70),g=n.n(v),f=n(34),b=(n(140),n(249),{apiKey:"AIzaSyBe7MCEn-_5jNAd286deOqEk8jvxvNX1aw",authDomain:"nss-iith-app.firebaseapp.com",projectId:"nss-iith-app",storageBucket:"nss-iith-app.appspot.com",messagingSenderId:"406717518600",appId:"1:406717518600:web:169bf354467b164f03d2bd",measurementId:"G-L793C8VNSX"}),j=function e(){Object(o.a)(this,e)};j.getFirebaseApp=function(){return"undefined"!==typeof window?f.a.apps.length?f.a.apps[0]:f.a.initializeApp(b):null},j.initialize_auth=function(e){var t=j.getFirebaseApp();null===t||void 0===t||t.auth().setPersistence(f.a.auth.Auth.Persistence.SESSION),null===t||void 0===t||t.auth().onAuthStateChanged((function(t){t&&e()}))},j.getUser=function(){var e,t,n=j.getFirebaseApp();return{name:null===n||void 0===n||null===(e=n.auth().currentUser)||void 0===e?void 0:e.displayName,email:null===n||void 0===n||null===(t=n.auth().currentUser)||void 0===t?void 0:t.email}},j.isValidTeamMember=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.getPageData("access_list");case 3:if(e.sent==={}){e.next=6;break}return e.abrupt("return",!0);case 6:e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",!1);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),j.getPageData=function(){var e=Object(h.a)(p.a.mark((function e(t){var n,a,s,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},a=j.getFirebaseApp(),s=null===a||void 0===a?void 0:a.firestore().collection("event_records"),e.next=5,null===s||void 0===s?void 0:s.doc(t).get();case 5:return i=e.sent,n=i?i.data():{},e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j.login=function(e,t){var n=j.getFirebaseApp(),a=new f.a.auth.GoogleAuthProvider;null===n||void 0===n||n.auth().signInWithPopup(a).then((function(t){e()})).catch((function(e){alert(e),t()}))},j.logout=function(e){var t=j.getFirebaseApp();null===t||void 0===t||t.auth().signOut().then((function(t){e()})).catch((function(e){alert("Oops... failed to logout")}))},j.saveChanges=function(e,t){var n=j.getFirebaseApp();null===n||void 0===n||n.firestore().collection("event_records").doc(e).set(t).then((function(e){alert("Sucessfully saved to database. Thank you!")})).catch((function(e){alert("Oops... Sorry, unable to save changes. This might have happened because, \n i) You may not have the edit access to the data \n ii) You may not have a stable network")}))};n(142);var m=n(27),O=n(2),x=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,a){var s;return Object(o.a)(this,n),(s=t.call(this,e,a)).onLogin=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=j.getUser().email,s.setState({isLoggedIn:!0,showMsg:!0,msg:"Verifying user "+t+"... Please wait..."}),e.next=4,j.isValidTeamMember();case 4:e.sent?(s.setState({isValidUser:!0,showMsg:!0,msg:"Login and verification success! Please wait..."}),s.props.onLoginSuccess()):s.showMessage("Sorry... You do not have access to this page!");case 6:case"end":return e.stop()}}),e)}))),s.showMessage=function(e){s.setState({showMsg:!0,msg:e})},s.logout=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.showMessage("Please wait..."),j.logout((function(){s.setState({isLoggedIn:!1,isValidUser:!1,showMsg:!0,msg:"Logged out!"}),s.props.onLogOut()}));case 2:case"end":return e.stop()}}),e)}))),s.login=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.login(Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.onLogin();case 1:case"end":return e.stop()}}),e)}))),(function(){s.showMessage("Oops... login failed. Please check your network connection")}));case 1:case"end":return e.stop()}}),e)}))),j.initialize_auth(s.onLogin),s.state={isLoggedIn:!1,isValidUser:!1,showMsg:!1,msg:"Currently logged in as "+j.getUser().email+". Verifying access level, Please wait!"},s}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.isLoggedIn&&!this.state.isValidUser&&this.onLogin();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(O.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",width:"100%"},children:Object(O.jsxs)("div",{className:"loginComponent",children:[Object(O.jsx)("img",{alt:"NSS IITH Logo",src:m.a+"/bannerNSS.jpg",style:{width:300}}),Object(O.jsx)("p",{className:"loginTitle",children:"QR Generator"}),this.state.isLoggedIn?Object(O.jsx)(g.a,{label:"Log out",onClick:this.logout}):Object(O.jsx)(g.a,{onClick:this.login}),this.state.showMsg?Object(O.jsx)("p",{className:"loginErrorMsg",children:this.state.msg}):null]})})}}]),n}(s.a.Component),y=(n(144),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,a){var s;return Object(o.a)(this,n),(s=t.call(this,e,a)).onSubmit=function(){s.props.onSubmit(s.state.name,s.state.date,s.state.url,s.state.eventkey)},s.state={name:s.props.defaultName,date:s.props.defaultDate,url:s.props.defaultUrl,eventkey:s.props.defaultKey},s}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(O.jsxs)("div",{className:"eventEditModal",id:this.props.defaultKey,children:[Object(O.jsx)("div",{className:"eventEditModalLabel",children:"Event Name:"}),Object(O.jsx)("textarea",{id:"inputname",className:"eventEditModalInput",rows:1,defaultValue:this.props.defaultName,style:this.props.isReadonly?{border:"2px solid darkgrey"}:{border:"2px solid grey"},readOnly:this.props.isReadonly,onChange:function(t){return e.setState({name:t.target.value})}}),Object(O.jsx)("div",{className:"eventEditModalLabel",children:"Event Date:"}),Object(O.jsx)("textarea",{id:"inputdate",className:"eventEditModalInput",rows:1,defaultValue:this.props.defaultDate,style:this.props.isReadonly?{border:"2px solid darkgrey"}:{border:"2px solid grey"},readOnly:this.props.isReadonly,onChange:function(t){return e.setState({date:t.target.value})}}),Object(O.jsx)("div",{className:"eventEditModalLabel",children:"Event Url:"}),Object(O.jsx)("textarea",{id:"inputurl",className:"eventEditModalInput",rows:6,defaultValue:this.props.defaultUrl,style:this.props.isReadonly?{border:"2px solid darkgrey"}:{border:"2px solid grey"},readOnly:this.props.isReadonly,onChange:function(t){return e.setState({url:t.target.value})}}),Object(O.jsx)("div",{className:"eventEditModalLabel",children:"Event Key:"}),Object(O.jsx)("textarea",{id:"inputkey",className:"eventEditModalInput",rows:1,defaultValue:this.props.defaultKey,style:this.props.isReadonly?{border:"2px solid darkgrey"}:{border:"2px solid grey"},readOnly:this.props.isReadonly,onChange:function(t){return e.setState({eventkey:t.target.value})}}),this.props.isReadonly?null:Object(O.jsx)("div",{className:"eventEditButton",onClick:this.onSubmit,children:this.props.buttonText})]})}}]),n}(s.a.Component)),w=(n(145),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.showModal?"modal display-block":"modal display-none";return Object(O.jsx)("div",{className:e,children:Object(O.jsx)("section",{className:"modal-main",children:this.props.children})})}}]),n}(s.a.Component)),N=(n(146),n(33)),S=n(128),k=n(126),C=n(127),L=n.n(C),R=n(251),I=function e(){Object(o.a)(this,e)};I.QrKeyGen=function(e,t,n){var a=I.getEventType(e),s=RegExp(/[\s\S]*viewform/).exec(e),i=e;null!=s&&(i=(i=s[0]).replace("viewform","formResponse"));var r="",o=RegExp(/&[\s\S]*prefilled-name/).exec(e);null!=o&&(r=(r=(r=o[0]).replace("=prefilled-name","")).replace("&",""));var c="",l=RegExp(/&[\s\S]*prefilled-email/).exec(e);null!=l&&(c=(c=(c=l[0]).replace("=prefilled-email","")).replace("&",""));var u="";if("cid"===a){var d=RegExp(/&[\s\S]*prefilled-bags/).exec(e);null!=d&&(u=(u=(u=d[0]).replace("=prefilled-bags","")).replace("&",""))}var p={event:t,type:a,key:n,url:i,name:r,email:c};return"cid"===a&&(p={event:t,type:a,key:n,url:i,name:r,email:c,bags:u}),JSON.stringify(p)},I.getEventType=function(e){return e.includes("prefilled-bags")?"cid":"default"},I.getKey=function(e,t){var n=new L.a(e),a=new Date;return n.encrypt(a.toLocaleString())},I.getRandomKey=function(){return Object(R.a)()};var E=I,M=(n(246),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,a){var s;return Object(o.a)(this,n),(s=t.call(this,e,a)).state={time:(new Date).toLocaleString(),isLoading:!0,qrvalue:""},s}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,s=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,200)}));case 2:t=E.getKey(this.props.eventkey,this.state.time),a=E.QrKeyGen(this.props.formUrl,this.props.eventName,t),this.setState({isLoading:!1,qrvalue:a}),n.callbackID=setInterval((function(){var e=E.getKey(s.props.eventkey,s.state.time),t=E.QrKeyGen(s.props.formUrl,s.props.eventName,e);s.setState({time:(new Date).toLocaleString(),qrvalue:t})}),2e3);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearInterval(n.callbackID);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(O.jsxs)("div",{className:"QRComponent",children:[Object(O.jsx)("img",{alt:"NSS IITH Logo",className:"bannerSmall",style:{width:300},src:m.a+"/bannerSmall.jpg"}),Object(O.jsx)("div",{className:"eventName",children:"Current event: "+this.props.eventName}),Object(O.jsxs)("div",{className:"QRIcon",children:[this.state.isLoading?null:Object(O.jsx)(k.QRCode,{level:"H",style:{width:300},value:this.state.qrvalue}),Object(O.jsx)("img",{alt:"NSS IITH Logo",className:"bannerNSS",style:{width:300,marginLeft:20},src:m.a+"/bannerNSS.jpg"})]}),this.state.isLoading?Object(O.jsx)("div",{className:"QRLoading",children:"Loading..."}):null,Object(O.jsx)("p",{className:"eventTime",children:"Current Date and Time: "+this.state.time})]})}}]),n}(s.a.Component));M.callbackID=void 0;var V=M,T=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,a){var s;return Object(o.a)(this,n),(s=t.call(this,e,a)).toggleModalState=function(){s.setState({showInfo:!s.state.showInfo,isEditable:!1,showQR:!1})},s.toggleModalEditState=function(){s.setState({isEditable:!s.state.isEditable})},s.onEdit=function(e,t,n,a){s.props.onEdit(e,t,n,a),s.toggleModalState()},s.toggleShowQR=function(){console.log("toggling"),s.setState({showQR:!s.state.showQR})},s.state={showInfo:!1,isEditable:!1,showQR:!1},s}return Object(c.a)(n,[{key:"render",value:function(){return Object(O.jsxs)("div",{id:this.props.eventKey,children:[Object(O.jsxs)(w,{showModal:this.state.showInfo,children:[Object(O.jsxs)("div",{className:"eventViewModalClose",children:[Object(O.jsx)(N.b,{color:"darkred",size:27,onClick:this.toggleModalState}),this.state.isEditable?Object(O.jsx)(S.a,{color:"darkblue",size:27,onClick:this.toggleModalEditState}):null]}),Object(O.jsx)(y,{defaultName:this.props.name,defaultDate:this.props.date,defaultUrl:this.props.url,defaultKey:this.props.eventKey,onSubmit:this.onEdit,buttonText:"Save",isReadonly:!this.state.isEditable},this.props.url+this.props.name+this.props.eventKey),this.state.isEditable?null:Object(O.jsxs)("div",{className:"eventViewButtonRow",children:[Object(O.jsx)("div",{className:"eventViewButton",onClick:this.toggleModalEditState,children:"Edit"}),Object(O.jsx)("div",{className:"eventViewButton",onClick:this.toggleShowQR,children:"QR Code"})]})]}),this.state.showQR?Object(O.jsxs)("div",{className:"eventViewQRBox",children:[Object(O.jsx)(N.b,{className:"eventViewQRClose",size:30,color:"darkred",onClick:this.toggleModalState}),Object(O.jsx)(V,{eventName:this.props.name,formUrl:this.props.url,eventkey:this.props.eventKey},this.props.eventKey+this.props.name+this.props.url)]}):null,Object(O.jsxs)("div",{className:"eventViewBox",onClick:this.toggleModalState,children:[Object(O.jsx)("p",{className:"eventViewTitle",onClick:this.toggleModalState,children:this.props.name}),Object(O.jsx)("p",{className:"eventViewDate",onClick:this.toggleModalState,children:this.props.date})]})]})}}]),n}(s.a.Component),D=(n(247),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,a){var s;return Object(o.a)(this,n),(s=t.call(this,e,a)).onCreate=function(e,t,n,a){var i={name:e,date:t,url:n,eventkey:a};s.state.events.unshift(i),j.saveChanges("events",{details:s.state.events}),s.setState({createNew:!1})},s.onEdit=function(e,t,n,a,i){var r={name:t,date:n,url:a,eventkey:i},o=s.state.events.map((function(e){return JSON.parse(JSON.stringify(e))}));o[e]=r,s.setState({events:o}),j.saveChanges("events",{details:s.state.events})},s.toggleCreateNew=function(){s.setState({createNew:!s.state.createNew})},s.state={events:[],isLoading:!0,createNew:!1},s}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getPageData("events");case 2:t=e.sent,this.setState({events:t.details,isLoading:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(O.jsxs)("div",{className:"eventsRecordPage",children:[Object(O.jsx)(w,{showModal:this.state.createNew,children:Object(O.jsxs)("div",{className:"eventsRecordCreateNew",children:[Object(O.jsx)(N.b,{color:"darkred",size:27,style:{alignSelf:"flex-end",marginRight:"10px",marginTop:"5px"},onClick:this.toggleCreateNew}),Object(O.jsx)(y,{defaultDate:"",defaultName:"",defaultUrl:"",defaultKey:E.getRandomKey(),buttonText:"Create",isReadonly:!1,onSubmit:this.onCreate})]})}),Object(O.jsxs)("div",{className:"eventsRecordTitle",children:[Object(O.jsx)("img",{alt:"NSS IITH Logo",style:{width:320,marginTop:15},src:m.a+"/bannerSmall.jpg"}),Object(O.jsxs)("div",{className:"eventsRecordHeadRow",children:[Object(O.jsx)("div",{className:"eventsRecordHeading",children:"Events Record"}),Object(O.jsxs)("div",{className:"eventsRecordAddNew",onClick:this.toggleCreateNew,children:[Object(O.jsx)(N.a,{className:"eventsRecordAddNewIcon",size:22}),Object(O.jsx)("div",{className:"eventsRecordAddNewTitle",children:"Add New Event"})]})]})]}),Object(O.jsx)("div",{className:"eventsRecordGrid",children:this.state.isLoading?Object(O.jsx)("div",{style:{color:"black"},children:"Loading please wait..."}):this.state.events.map((function(t,n){return Object(O.jsx)(T,{name:t.name,date:t.date,url:t.url,eventKey:t.eventkey,onEdit:function(t,a,s,i){return e.onEdit(n,t,a,s,i)}},t.eventkey+t.url+t.name)}))})]})}}]),n}(s.a.Component)),U=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,a){var s;return Object(o.a)(this,n),(s=t.call(this,e,a)).onLoggedIn=function(){s.setState({isValidUserLoggedIn:!0})},s.onLoggedOut=function(){s.setState({isValidUserLoggedIn:!1})},s.state={isValidUserLoggedIn:!1},s}return Object(c.a)(n,[{key:"render",value:function(){return Object(O.jsx)("div",{className:"App",children:Object(O.jsx)("header",{className:"App-header",children:this.state.isValidUserLoggedIn?Object(O.jsx)(D,{}):Object(O.jsx)(x,{onLoginSuccess:this.onLoggedIn,onLogOut:this.onLoggedOut})})})}}]),n}(s.a.Component),K=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,252)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),i(e),r(e)}))};r.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(U,{})}),document.getElementById("root")),K()},27:function(e){e.exports=JSON.parse('{"a":"https://anuragreddy2000.github.io/NSS-IITH-QR-Gen"}')}},[[248,1,2]]]);
//# sourceMappingURL=main.dcd2e7a4.chunk.js.map